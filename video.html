<!DOCTYPE html>
<html lang="de">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
        <title>InfoActiveVideo</title>

        <link rel="stylesheet" href="style.css">
		    <link rel="stylesheet" href="video-page-style.css">
    </head>

    <body>
        <header>
          <div class="navbar">
            <nav>
                <a href="index.html">Home</a>
                <a class="active" href="video.html">Video</a>
                <a href="team.html">Team</a>
            </nav>
            <div class="logo">
                <a href="index.html">
                    <img src="logo_withName.png" alt="Logo">
                </a>
            </div>
          </div>
        </header>
		    <div class="video-page-title">
            <h1>Los Angeles, an aerial perspective from a helicopter</h1>
            <br>
        </div>

        <div class="video-page-table">
          <table>
            <tr>
              <td class="video-column">
                <div class="player-column">
                  <video id="videoID" controls nopictureinpicture controlslist="nofullscreen">
                    <source src="video/LosAngelesArial.mp4" type="video/mp4">
                    <source src="video/LosAngelesArial.ogg" type="video/ogg">
                    Your browser does not support the video tag.
                  </video>
                </div> 										
              </td>
              <td class="text-column">
                <div class="infobox" style="border: 3px blue">
                  <h2>Tutorial</h2>
                  </br>
                  <p style="border: 3px red">
                    Here is all the info needed to use this site.
                    We will explain here how the video works and how you can see different kinds of
                    information. There will sometimes also be a link to an external site, which will offer
                    you more information, if you want to look into an item or subject closer. 
                  </p>
                  </br>
                  <p>
                    Here is an example:
                    <a href="http://www.google.at">Search for anything</a>
                  </p>
                </div>
              </td>
            </tr>
          </table>
        </div>
        <div class="box-container" id="box-container">
        </div>
    </body>

    <script src="video.js"></script>
    <script>
      // Assuming your JSON file is in the same directory as your HTML file
      fetch('video.json')
        .then(response => response.json())
        .then(data => {
          const timestamps = data.video.timestamps;
          const buildings = data.video.buildings;
          console.log(buildings);
          var video = document.getElementById("videoID");
          var boxContainer = document.getElementById("box-container"); 
          var index = 0;

          video.addEventListener("timeupdate", function() {
            if ((index < timestamps.length) && (video.currentTime >= timestamps[index].timestamp)) {
              timestamps[index].buildings.forEach(building => {
                addBox(building, boxContainer, timestamps[index].timestamp);
              });
              index += 1;
            }
            const boxes = document.querySelectorAll(".box");
            const infoBoxText = document.querySelector(".infobox p");
            
            boxes.forEach(box => {
              box.addEventListener("click", function() {
                var boxID = box.getAttribute("id");
                var description;

                buildings.forEach(building => {
                  if (building.id == boxID) {
                    description = building.description;
                    return;
                  }
                });

                updateInfoBox(infoBoxText, description);
                video.pause();
              });

              let end = box.getAttribute("data-end");
              let start = box.getAttribute("data-start");
              if ((video.currentTime >= end) || (video.currentTime <= start)) {
                boxContainer.removeChild(box.parentNode);
              }
            });
          });
        })
        .catch(error => console.error('Error fetching JSON:', error));
    </script>
</html>